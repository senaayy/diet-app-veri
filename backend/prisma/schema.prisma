// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Danisan {
  id               Int      @id @default(autoincrement())
  name             String
  height           Float?   // Boy (cm)
  targetCalories   Int
  protein          Int
  carbs            Int
  fat              Int
  allergens        Json?
  currentWeight    Float
  targetWeight     Float
  startWeight      Float
  weeklyProgress   Json?    // [{week: 1, weight: 75.5, date: "2025-01-01"}]
  adherence        Int
  mealsLogged      Int
  totalMeals       Int
  aiUsageCount     Int      @default(0)
  weeklyMenu       Json?    @default("{}")
  pendingApprovals Json?
  weightEntries    WeightEntry[]
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt
}

model WeightEntry {
  id        Int      @id @default(autoincrement())
  danisanId Int
  weight    Float
  week      Int
  date      DateTime @default(now())
  notes     String?
  danisan   Danisan  @relation(fields: [danisanId], references: [id], onDelete: Cascade)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([danisanId, week])
}

 